(()=>{var t={485:(t,e,n)=>{t.exports=n(894)},894:function(t,e){var n,s,o;(function(){var r,i,u,p,c,a,l,h,d,f,y,v,x,g,E;u=Math.floor,f=Math.min,i=function(t,e){return t<e?-1:t>e?1:0},d=function(t,e,n,s,o){var r;if(null==n&&(n=0),null==o&&(o=i),n<0)throw new Error("lo must be non-negative");for(null==s&&(s=t.length);n<s;)o(e,t[r=u((n+s)/2)])<0?s=r:n=r+1;return[].splice.apply(t,[n,n-n].concat(e)),e},a=function(t,e,n){return null==n&&(n=i),t.push(e),g(t,0,t.length-1,n)},c=function(t,e){var n,s;return null==e&&(e=i),n=t.pop(),t.length?(s=t[0],t[0]=n,E(t,0,e)):s=n,s},h=function(t,e,n){var s;return null==n&&(n=i),s=t[0],t[0]=e,E(t,0,n),s},l=function(t,e,n){var s;return null==n&&(n=i),t.length&&n(t[0],e)<0&&(e=(s=[t[0],e])[0],t[0]=s[1],E(t,0,n)),e},p=function(t,e){var n,s,o,r,p,c;for(null==e&&(e=i),p=[],s=0,o=(r=function(){c=[];for(var e=0,n=u(t.length/2);0<=n?e<n:e>n;0<=n?e++:e--)c.push(e);return c}.apply(this).reverse()).length;s<o;s++)n=r[s],p.push(E(t,n,e));return p},x=function(t,e,n){var s;if(null==n&&(n=i),-1!==(s=t.indexOf(e)))return g(t,0,s,n),E(t,s,n)},y=function(t,e,n){var s,o,r,u,c;if(null==n&&(n=i),!(o=t.slice(0,e)).length)return o;for(p(o,n),r=0,u=(c=t.slice(e)).length;r<u;r++)s=c[r],l(o,s,n);return o.sort(n).reverse()},v=function(t,e,n){var s,o,r,u,a,l,h,y,v;if(null==n&&(n=i),10*e<=t.length){if(!(r=t.slice(0,e).sort(n)).length)return r;for(o=r[r.length-1],u=0,l=(h=t.slice(e)).length;u<l;u++)n(s=h[u],o)<0&&(d(r,s,0,null,n),r.pop(),o=r[r.length-1]);return r}for(p(t,n),v=[],a=0,y=f(e,t.length);0<=y?a<y:a>y;0<=y?++a:--a)v.push(c(t,n));return v},g=function(t,e,n,s){var o,r,u;for(null==s&&(s=i),o=t[n];n>e&&s(o,r=t[u=n-1>>1])<0;)t[n]=r,n=u;return t[n]=o},E=function(t,e,n){var s,o,r,u,p;for(null==n&&(n=i),o=t.length,p=e,r=t[e],s=2*e+1;s<o;)(u=s+1)<o&&!(n(t[s],t[u])<0)&&(s=u),t[e]=t[s],s=2*(e=s)+1;return t[e]=r,g(t,p,e,n)},r=function(){function t(t){this.cmp=null!=t?t:i,this.nodes=[]}return t.push=a,t.pop=c,t.replace=h,t.pushpop=l,t.heapify=p,t.updateItem=x,t.nlargest=y,t.nsmallest=v,t.prototype.push=function(t){return a(this.nodes,t,this.cmp)},t.prototype.pop=function(){return c(this.nodes,this.cmp)},t.prototype.peek=function(){return this.nodes[0]},t.prototype.contains=function(t){return-1!==this.nodes.indexOf(t)},t.prototype.replace=function(t){return h(this.nodes,t,this.cmp)},t.prototype.pushpop=function(t){return l(this.nodes,t,this.cmp)},t.prototype.heapify=function(){return p(this.nodes,this.cmp)},t.prototype.updateItem=function(t){return x(this.nodes,t,this.cmp)},t.prototype.clear=function(){return this.nodes=[]},t.prototype.empty=function(){return 0===this.nodes.length},t.prototype.size=function(){return this.nodes.length},t.prototype.clone=function(){var e;return(e=new t).nodes=this.nodes.slice(0),e},t.prototype.toArray=function(){return this.nodes.slice(0)},t.prototype.insert=t.prototype.push,t.prototype.top=t.prototype.peek,t.prototype.front=t.prototype.peek,t.prototype.has=t.prototype.contains,t.prototype.copy=t.prototype.clone,t}(),s=[],void 0===(o="function"==typeof(n=function(){return r})?n.apply(e,s):n)||(t.exports=o)}).call(this)}},e={};function n(s){var o=e[s];if(void 0!==o)return o.exports;var r=e[s]={exports:{}};return t[s].call(r.exports,r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t,e,s,o,r,i,u;function p(t,e){return"z"in t?"z"in e&&t.x===e.x&&t.y===e.y&&t.z===e.z:t.x===e.x&&t.y===e.y}function c(t,e){Object.entries(t).forEach((([t,n],s)=>{e(t,n,s)}))}function a(t,e){const n=e.x-t.x,s=e.y-t.y;return Math.sqrt(n*n+s*s)}function l(t,e){const n={},s=[];return c({R:{x:1,y:0},L:{x:-1,y:0},D:{x:0,y:1},U:{x:0,y:-1}},((o,r)=>{var i;const u=e.x+r.x,p=e.y+r.y;!1===(null===(i=t[p])||void 0===i?void 0:i[u])&&(n[o]=!0,s.push(r))})),c({RD:{x:1,y:1},RU:{x:1,y:-1},LU:{x:-1,y:-1},LD:{x:-1,y:1}},((o,r)=>{var i;const u=o.split("").every((t=>n[t])),p=e.x+r.x,c=e.y+r.y;u&&!1===(null===(i=t[c])||void 0===i?void 0:i[p])&&s.push(r)})),s}!function(t){t.CREATE_TASK="create_task",t.COMPLETE_TASK="complete_task",t.CANCEL_TASK="cancel_task",t.UPDATE_POINTS_COST="update_points_cost"}(t||(t={})),function(t){t.MIDGAME="midgame",t.REWARDED="rewarded"}(e||(e={})),function(t){t.SYSTEM="SYSTEM",t.GAMEOVER="GAMEOVER",t.WORLD="WORLD",t.SCREEN="SCREEN",t.MENU="MENU"}(s||(s={})),function(t){t.START="start",t.FINISH="finish",t.UPDATE_SETTINGS="update_settings"}(o||(o={})),function(t){t.AUDIO="AUDIO",t.EFFECTS="EFFECTS",t.TUTORIAL="TUTORIAL"}(r||(r={})),function(t){t.EASY="EASY",t.NORMAL="NORMAL",t.HARD="HARD"}(i||(i={})),function(t){t.NO_BLOOD="NO_BLOOD",t.ADS="ADS"}(u||(u={})),r.TUTORIAL,r.AUDIO,r.EFFECTS;var h=n(485),d=n.n(h);class f{constructor(t,{position:e,cost:n=1,distance:s}){this.listOpened=null,this.x=e.x,this.y=e.y,this.distance=s,this.cost=n,this.parent=t}bestGuessDistance(){return this.cost+this.distance}getCost(){return this.cost}setCost(t){this.cost=t}getParent(){return this.parent}setParent(t){this.parent=t}isNewList(){return null===this.listOpened}isListOpened(){return!0===this.listOpened}openList(){this.listOpened=!0}closeList(){this.listOpened=!1}getPath(){const t=[{x:this.x,y:this.y}];let e=this.getParent();for(;e;)t.push({x:e.x,y:e.y}),e=e.getParent();return t.reverse(),t}}class y{constructor({id:t,from:e,to:n,grid:s,compress:o=!1}){this.tree=[],this.compress=!1,this.id=t,this.from=e,this.to=n,this.grid=s,this.compress=o,this.nodes=new(d())(((t,e)=>t.bestGuessDistance()-e.bestGuessDistance()));const r=new f(null,{position:e,distance:a(e,n)});this.addNode(r)}takeLastNode(){var t;return null!==(t=this.nodes.pop())&&void 0!==t?t:null}addNode(t){this.nodes.push(t),this.tree[t.y]||(this.tree[t.y]=[]),this.tree[t.y][t.x]=t}pickNode(t){var e;return null===(e=this.tree[t.y])||void 0===e?void 0:e[t.x]}upNode(t){this.nodes.updateItem(t)}failure(){self.postMessage({event:t.COMPLETE_TASK,payload:{id:this.id,path:null}})}complete(e){let n=e.getPath();this.compress&&(n=y.CompressPath(n)),self.postMessage({event:t.COMPLETE_TASK,payload:{id:this.id,path:n}})}checkAdjacentNode(t,e,n){const s={x:t.x+e.x,y:t.y+e.y},o=t.getCost()+function(t,e,n){var s,o,r,i,u,p;const c=t.x+e.x,a=t.y+e.y,l=null!==(o=null===(s=n[a])||void 0===s?void 0:s[c])&&void 0!==o?o:1;return Math.abs(e.x)+Math.abs(e.y)!==1?l*Math.SQRT2+(null!==(i=null===(r=n[t.y])||void 0===r?void 0:r[c])&&void 0!==i?i:0)+(null!==(p=null===(u=n[a])||void 0===u?void 0:u[t.x])&&void 0!==p?p:0):l}(t,e,n),r=this.pickNode(s);if(r)o<r.getCost()&&(r.setCost(o),r.setParent(t),this.upNode(r));else{const e=new f(t,{position:s,cost:o,distance:a(s,this.to)});e.openList(),this.addNode(e)}}static CompressPath(t){if(t.length<3)return t;const e=[],n=Object.assign({},t[0]);let s=Object.assign({},t[1]),o={x:0,y:0};o=y.GetDirection(s,n),e.push(n);for(let n=2;n<t.length;n++){const r=Object.assign({},s),i=Object.assign({},o);s=Object.assign({},t[n]),o=y.GetDirection(s,r),p(o,i)||e.push(r)}return e.push(s),e}static GetDirection(t,e){const n={x:t.x-e.x,y:t.y-e.y},s=Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2));return n.x/=s,n.y/=s,n}}const v=new class{constructor(){this.pointsCost=[],this.taskQueue=[]}createTask(t){this.taskQueue.push(t)}cancelTask(t){const e=this.taskQueue.findIndex((e=>e.id===t));-1!==e&&this.taskQueue.splice(e,1)}updatePointsCost(t){this.pointsCost=t}processing(){for(;this.taskQueue.length>0;){const t=this.taskQueue[0],e=t.takeLastNode();e?p(t.to,e)?(this.taskQueue.shift(),t.complete(e)):(e.closeList(),l(t.grid,e).forEach((n=>{t.checkAdjacentNode(e,n,this.pointsCost)}))):(this.taskQueue.shift(),t.failure())}}};setInterval((()=>{v.processing()}),100),self.onmessage=({data:e})=>{switch(e.event){case t.CREATE_TASK:const n=new y(e.payload);v.createTask(n);break;case t.CANCEL_TASK:v.cancelTask(e.payload.id);break;case t.UPDATE_POINTS_COST:v.updatePointsCost(e.payload)}}})()})();
//# sourceMappingURL=bundle.3c2fb6bfda5f2edf242b.worker.js.map